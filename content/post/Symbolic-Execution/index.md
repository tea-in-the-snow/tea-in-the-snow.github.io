---
title: "符号执行"
description: 
date: 2025-03-10T10:27:53+08:00
categories:
    - Program Analysis
tags:
    - Symbolic Execution
hidden: false
comments: true
draft: true
---

符号执行是一种抽象执行程序的方法，使得一次抽象执行能够覆盖程序中通过特定代码路径的多个可能输入。这种执行方式将这些输入视为符号，并“返回”一个用表示这些输入值的符号常量来表达的结果。

与抽象解释相比，符号执行的通用性较低，因为它不会探索程序中的所有路径。然而，为了确保分析终止，抽象解释有时必须在某些地方进行近似，符号执行可以在这些地方避免近似。这意味着符号执行可以避免发出虚假警告；符号执行发现的任何错误都代表了程序中一条真实且可行的路径，并且可以通过一个展示该错误的测试用例来验证。

## A Generalization of Testing

符号执行是一种对测试进行泛化（Generalization）的方法。传统的测试涉及在一个具体输入上具体执行程序，并检查结果。相比之下，符号执行则考虑程序在一组相关输入上的抽象执行。

```C
func(int a, int b, int c) {
    int x = 0, y = 0, z = 0;
    if (a) {
        x = -2;
    }
    if (b < 5) {
        if (!a && c) {
            y = 1;
        }
        z = 2;
    }
    assert(x + y + z != 3);
}
```

以 a = 1， b = 2， c = 1 运行这段代码会导致 assert 失败，如果我们作为测试者足够优秀或者足够幸运，可能会偶然发现这个输入组合，并进一步归纳出导致这一问题的输入空间组合（从而修复这个问题）。

与在具体输入（例如 a = 1、b = 2 和 c = 1）上执行代码不同，​符号执行在符号输入（symbolic inputs）上对代码进行评估，例如 a = α、b = β、c = γ，并基于这些符号值跟踪执行过程。如果某个分支条件依赖于未知的符号值，符号执行引擎会简单地选择其中一个分支，并记录导致该分支的符号值条件。在完成一次符号执行后，引擎可以返回到已选择的分支，探索程序中的其他路径。

当然，带有循环的程序具有无限数量的路径，因此穷举符号执行是不可能的。相反，工具会采用一些启发式方法，例如：

- 探索所有执行树到一定深度
- 将循环迭代限制为一个较小的常数
- 尝试找到至少一条覆盖程序中每一行代码的路径